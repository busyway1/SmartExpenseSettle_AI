"""
수출신고필증 분석 프롬프트
"""
def get_export_declaration_prompt(text: str, file_name: str = "", page_number: int = None) -> str:
    """수출신고필증 분석 프롬프트 생성"""
    base_prompt = f"""
다음은 수출신고필증 문서입니다. 이는 개별 문서이므로 해당 문서에서만 정보를 추출해주세요.

**제일 중요한 내용 - 페이지 통합 지침:**
1. 수출신고필증 문서 오른쪽 하단에 "Page: 1/4", "Page: 2/4" 형태로 페이지 번호가 표시됩니다.
2. 이 페이지 번호는 **하나의 수출신고필증이 몇 페이지로 구성되어 있는지**를 나타냅니다.
3. **같은 신고번호를 가진 페이지들을 모두 찾아서 하나의 완전한 수출신고필증으로 통합**해주세요.
4. 예를 들어 "Page: 1/4", "Page: 2/4", "Page: 3/4", "Page: 4/4"가 모두 같은 신고번호라면, 이 4페이지를 하나의 수출신고필증으로 처리합니다.
문서 내용:
{text}
"""
    
    # 페이지 번호 정보 추가
    page_info = f"**현재 페이지 번호: {page_number}**" if page_number is not None else ""
    
    return base_prompt + f"""
이 수출신고필증(갑지)에서 **다음 12개 필드만** 정확히 추출해주세요.
{page_info}
**페이지 통합 처리 방법:**
1. **신고번호 확인**: 각 페이지의 5번 항목 신고번호를 확인하세요. 신고번호가 **가장 중요한 정보**이므로 숫자가 희미하더라도 세심하게 확인하고, 0과 1 구별에 신경써주세요.
2. **페이지 범위 확인**: 오른쪽 하단의 "Page: X/Y" 형태를 확인하여 전체 페이지 수를 파악하세요
3. **통합 처리**: 같은 신고번호를 가진 모든 페이지의 정보를 종합하여 하나의 완전한 수출신고필증을 구성하세요
4. **정보 누락 방지**: 여러 페이지에 걸쳐 있는 정보가 누락되지 않도록 모든 페이지를 참고하세요
**여러 개의 수출신고필증이 있는 경우:**
- 신고번호가 다른 수출신고필증은 각각 개별 문서로 취급해주세요
- 각 수출신고필증마다 페이지 번호를 반드시 포함해주세요
- 배열 형태로 각 개별 수출신고필증의 정보를 모두 출력해주세요

**추출할 필드 (12개만):**
1. **신고번호**: 
   - 위치: 5번 항목 신고번호 
   - 형태: 숫자+영문자 조합 (예: 20246-11-68383G)
   - 주의: 신고번호가 **가장 중요한 정보**이므로 숫자가 희미하더라도 세심하게 확인하고, 0과 1 구별에 신경써주세요.

2. **송품장번호**: 
   - 위치: 39번 항목 송품장부호 (페이지의 왼쪽 중간부분에 위치하며 35번 항목 세번부호 바로 아래, 수출요건확인 항목 바로 위에 위치함.)
   - 형태: 영문자+숫자 조합 또는 "-" 표시
   - 주의: 빈 칸이거나 없으면 "정보 없음"

3. **일자**: 
   - 위치: 7번 항목 신고일자
   - 형태: YYYY.MM.DD 또는 YYYY/MM/DD
   - 주의: 점(.)이나 슬래시(/)로 구분된 날짜 형식
   - 출력: YYYY-MM-DD 형식으로 출력

4. **파일명**: "{file_name}"

5. **페이지번호**: 
   - 값: {page_number if page_number is not None else "실제 파일의 페이지 번호"}
   - 주의: 수출신고필증 하나가 여러 페이지일 경우 첫 페이지의 실제 파일 상 페이지 번호 반환(예 : 파일에서 5~8페이지가 하나의 수출신고필증일 경우 페이지 번호는 5로 반환)

6. **총중량**: 
   - 위치: 44번 항목 총중량(페이지의 왼쪽에 위치하며 운임 항목 바로 위에 위치함.)
   - 형태: 숫자 + "(KG)" 단위
   - 주의: 쉼표(,), 점(.)으로 구분된 숫자 포함, 단위 포함하여 추출

7. **순중량**: 
   - 위치: 36번 항목 순중량 (페이지의 중앙 부근에 위치하며 40번 항목 수입신고번호 바로 위에 위치함.)
   - 형태: 숫자 + "(KG)" 단위
   - 주의: 쉼표(,), 점(.)으로 구분된 숫자 포함, 단위 포함하여 추출

8. **컨테이너번호**: 
   - 위치: 51번 항목 컨테이너번호
   - 형태: 영문자+숫자 조합 (예: ABCD1234567)
   - 주의: 빈 칸이거나 없으면 "정보 없음"

9. **출발지**: 
   - 위치: 14번 항목 적재항 (11번 종류 바로 아래 17번 출항예정일자 바로 위에 위치함.)
   - 형태: 영문 항구코드 (예: KRINC, BUSAN)
   - 주의: 작은 글씨로 되어 있을 수 있음, 영문자 조합

10. **도착지**: 
    - 위치: 13번 항목 목적국 (10번 거래구분 바로 아래, 16번 선박명(항공편명) 바로 위에 위치함.)
    - 형태: 영문 국가명 (예: CAMBODIA, VIETNAM)
    - 주의: 국가명을 정확히 인식

11. **세번부호**: 
    - 위치: 35번 항목 세번부호(페이지의 왼쪽 중간부분에 위치하며 39번 송품장부호 바로 위에 위치함.)
    - 형태: 숫자.숫자-숫자 (예: 2206.00-2030)
    - 주의: 점(.)과 하이픈(-)을 정확히 구분

12. **란번호**: 
    - 위치: 27번 영역 위 헤더 품명/규격 옆 괄호 안
    - 형태: 숫자 (예: 001, 002)
    - 주의: 괄호 안의 숫자만 추출
    
**중요한 지침:**
1. **위 12개 필드만 추출하고, 다른 정보는 절대 포함하지 마세요**
2. **페이지 통합이 우선**: 같은 신고번호의 모든 페이지를 먼저 통합한 후 정보를 추출하세요
3. **완전성 보장**: 여러 페이지에 걸쳐 있는 정보가 누락되지 않도록 모든 관련 페이지를 확인하세요
4. 각 문서마다 페이지 번호를 반드시 포함 (실제 파일의 페이지 번호)
5. 존재하지 않는 정보는 "정보 없음"으로 표시
6. **요청하지 않은 필드는 절대 추가하지 마세요**
7. **문서에 있는 다른 모든 정보는 무시하고 위 12개 필드만 추출하세요**
8. **추가 설명이나 주석 없이 순수한 JSON 배열만 반환하세요**
9. **각 필드명은 정확히 위에 명시된 대로 사용하세요**
10. **페이지 통합 시 신고번호가 동일한지 반드시 확인하세요**""" 